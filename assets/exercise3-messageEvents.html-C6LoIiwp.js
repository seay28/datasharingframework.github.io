import{_ as o}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as l,b as n,e as t,f as a,d as i,a as r,r as h,o as d}from"./app-CJIENTLq.js";const p="/photos/guideline/tutorial/ex3.png",c={};function g(k,e){const s=h("RouteLink");return d(),l("div",null,[n("p",null,[t(s,{to:"/oldstable/tutorial/prerequisites.html"},{default:a(()=>e[0]||(e[0]=[i("Prerequisites")])),_:1}),e[6]||(e[6]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise1-simpleProcess.html"},{default:a(()=>e[1]||(e[1]=[i("Exercise 1")])),_:1}),e[7]||(e[7]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise11-processDebugging.html"},{default:a(()=>e[2]||(e[2]=[i("Exercise 1.1")])),_:1}),e[8]||(e[8]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise2-inputParameters.html"},{default:a(()=>e[3]||(e[3]=[i("Exercise 2")])),_:1}),e[9]||(e[9]=i(" | Exercise 3 | ")),t(s,{to:"/oldstable/tutorial/exercise4-exclusiveGateways.html"},{default:a(()=>e[4]||(e[4]=[i("Exercise 4")])),_:1}),e[10]||(e[10]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise5-eventBasedGateways.html"},{default:a(()=>e[5]||(e[5]=[i("Exercise 5")])),_:1})]),e[33]||(e[33]=r('<h2 id="exercise-3-message-events" tabindex="-1"><a class="header-anchor" href="#exercise-3-message-events"><span>Exercise 3 - Message Events</span></a></h2><p>Communication between organizations is modeled using message flow in BPMN processes. The third exercise shows how a process at one organization can trigger a process at another organization.</p><p>To demonstrate communication between two organizations we will configure message flow between the processes <code>highmedorg_helloDic</code> and <code>highmedorg_helloCos</code>. The processes are then to be executed at the organizations <code>Test_DIC</code> and <code>Test_COS</code> respectively in the docker test setup, with the former triggering execution of the latter by automatically sending a <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> from organization <code>Test_DIC</code> to organization <code>Test_COS</code>.</p><h3 id="introduction" tabindex="-1"><a class="header-anchor" href="#introduction"><span>Introduction</span></a></h3><hr><h4 id="message-flow-and-fhir-task-resources" tabindex="-1"><a class="header-anchor" href="#message-flow-and-fhir-task-resources"><span>Message Flow and FHIR Task resources</span></a></h4><p>BPMN processes are instantiated and started within the DSF by creating a matching FHIR <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource in the DSF FHIR server. This is true for executing a process on the local DSF BPE server by manually creating a <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource, but also works by creating and starting a process instance at a remote DSF BPE server from an executing process automatically.</p><p>In order to exchange information between different processes, for example at two different organizations, BPMN message flow is used. Typically represented by a dashed line arrow between elements with black (send) and white (receive) envelop icons. The following BPMN collaboration diagram shows two processes. The process at &quot;Organization 1&quot; is sending a message to &quot;Organization 2&quot; which results in the instantiation and execution of new process instance at the second organization.</p><figure><img src="'+p+'" alt="Message Flow" tabindex="0" loading="lazy"><figcaption>Message Flow</figcaption></figure><p>Every time message flow is used in a BPMN process for the DSF, a corresponding FHIR <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> profile needs to be specified for every interaction. This profile specifies which process should be started or continued and what the message name is when correlating the appropriate <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-start-event" target="_blank" rel="noopener noreferrer">Message Start Event</a> or <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-intermediate-catching-event" target="_blank" rel="noopener noreferrer">Intermediate Message Catch Event</a>. A <em>Business Key</em> and a <em>Correlation Key</em> are specified if different process instances need to be linked to a single execution, for example to be able to send a message back.</p><h4 id="bpmn-process-definition-key-vs-fhir-task-instantiatesuri-and-activitydefinition-url-version" tabindex="-1"><a class="header-anchor" href="#bpmn-process-definition-key-vs-fhir-task-instantiatesuri-and-activitydefinition-url-version"><span>BPMN Process Definition Key vs. FHIR Task.instantiatesUri and ActivityDefinition.url / version</span></a></h4><p>FHIR ActivityDefinition resources are used to announce what processes can be instantiated at a given DSF instance. They also control what kind of organization can request the instantiation or continuation of a process instance and what kind of organization is allowed to fulfill the request.</p><p>In order to link the FHIR and BPMN worlds the BPMN process definition key needs to be specified following the pattern <code>^[-a-zA-Z0-9]+_[-a-zA-Z0-9]+$</code> for example:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>domainorg_processKey</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>In addition the BPM process needs to specify a process version with the pattern <code>^\\d+.\\d+.\\d+$</code> for example:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>1.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>This results in a canonical URL used to identify the process, for example:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>http://domain.org/bpe/Process/processKey/1.0.0</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>The canonical URL is used for <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task.instantiatesUri</a> and <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition.url / version</a>.</p><h4 id="activitydefinitions-for-the-dsf" tabindex="-1"><a class="header-anchor" href="#activitydefinitions-for-the-dsf"><span>ActivityDefinitions for the DSF</span></a></h4><p>FHIR <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> resources are used to announce what processes can be instantiated at a given DSF instance and contain the authorization rules for the specified process. <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> for the DSF need to comply with the <a href="http://highmed.org/fhir/StructureDefinition/activity-definition" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/activity-definition</a> profile, with authorization rules configured using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization</a> extension.</p><p>The authorization extension needs to be configured at least once and has four sub extensions:</p><h5 id="message-name-1-1" tabindex="-1"><a class="header-anchor" href="#message-name-1-1"><span>message-name [1..1]</span></a></h5><p>String value specifying the message name of <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-start-event" target="_blank" rel="noopener noreferrer">Message Start Event</a>, <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-intermediate-catching-event" target="_blank" rel="noopener noreferrer">Intermediate Message Catch Event</a> or <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/tasks/receive-task/" target="_blank" rel="noopener noreferrer">Message Receive Task</a> this authorization rule should match. Can only be specified once per authorization rule extension.</p><h5 id="task-profile-1-1" tabindex="-1"><a class="header-anchor" href="#task-profile-1-1"><span>task-profile [1..1]</span></a></h5><p>Canonical URL value specifying the <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> profile this authorization rule should match. Can only be specified once per authorization rule extension.</p><h5 id="requester-1" tabindex="-1"><a class="header-anchor" href="#requester-1"><span>requester [1..]</span></a></h5><p>Coding value matching entries from the <a href="http://highmed.org/fhir/ValueSet/process-authorization-requester" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/ValueSet/process-authorization-requester</a> ValueSet:</p>',28)),n("ul",null,[e[16]||(e[16]=r('<li><p>LOCAL_ORGANIZATION A local organization with a specific identifier. The organization identifier needs to specified using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization</a> extension.</p></li><li><p>REMOTE_ORGANIZATION A remote (non local) organization with a specific identifier. The organization identifier needs to specified using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization</a> extension.</p></li><li><p>LOCAL_ROLE A local organizations with a specific role defined via <a href="http://hl7.org/fhir/R4/organizationaffiliation.html" target="_blank" rel="noopener noreferrer">OrganizationAffiliation</a>. Role and consortium identifier need to be specified using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role</a> extension.</p></li>',3)),n("li",null,[n("p",null,[e[12]||(e[12]=i("REMOTE_ROLE A remote (non local) organizations with a specific role defined via ")),t(s,{to:"/oldstable/tutorial/hl7.org/fhir/R4/organizationaffiliation.html"},{default:a(()=>e[11]||(e[11]=[i("OrganizationAffiliation")])),_:1}),e[13]||(e[13]=i(". Role and consortium identifier need to be specified using the ")),e[14]||(e[14]=n("a",{href:"http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role",target:"_blank",rel:"noopener noreferrer"},"http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role",-1)),e[15]||(e[15]=i(" extension."))])]),e[17]||(e[17]=n("li",null,[n("p",null,"LOCAL_ALL All local organizations regardless of their identifier or role in a consortium.")],-1)),e[18]||(e[18]=n("li",null,[n("p",null,"REMOTE_ALL All remote (non local) organizations regardless of their identifier or role in a consortium.")],-1))]),e[34]||(e[34]=r(`<h5 id="recipient-1" tabindex="-1"><a class="header-anchor" href="#recipient-1"><span>recipient [1..]</span></a></h5><p>Coding value matching entries from the <a href="http://highmed.org/fhir/ValueSet/process-authorization-recipient" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/ValueSet/process-authorization-recipient</a> ValueSet.</p><ul><li><p>LOCAL_ORGANIZATION Organization with a specific identifier. The organization identifier needs to specified using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization</a> extension.</p></li><li><p>LOCAL_ROLE Organizations with a specific role defined via <a href="http://hl7.org/fhir/R4/organizationaffiliation.html" target="_blank" rel="noopener noreferrer">OrganizationAffiliation</a>. Role and consortium identifier need to be specified using the <a href="http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/extension-process-authorization-consortium-role</a> extension.</p></li><li><p>LOCAL_ALL All organizations regardless of their identifier or role in a consortium.</p></li></ul><p>The local organization of a DSF instance is configured using the environment variables <a href="https://github.com/highmed/highmed-dsf/wiki/DSF-0.7.0-Configuration-Parameters-FHIR#org_highmed_dsf_fhir_server_organization_identifier_value" target="_blank" rel="noopener noreferrer">ORG_HIGHMED_DSF_FHIR_SERVER_ORGANIZATION_IDENTIFIER_VALUE</a> for the DSF FHIR server and <a href="https://github.com/highmed/highmed-dsf/wiki/DSF-0.7.0-Configuration-Parameters-BPE#org_highmed_dsf_bpe_fhir_server_organization_identifier_value" target="_blank" rel="noopener noreferrer">ORG_HIGHMED_DSF_BPE_FHIR_SERVER_ORGANIZATION_IDENTIFIER_VALUE</a> for the DSF BPE server.</p><h4 id="authorization-extension-example" tabindex="-1"><a class="header-anchor" href="#authorization-extension-example"><span>Authorization Extension Example</span></a></h4><p>The following example specifies that process execution can only be requested by a organization with a specific identifier and only allows execution of the process in the DSF instance of an organization with a specific identifier.</p><div class="language-xml line-numbers-mode" data-highlighter="shiki" data-ext="xml" data-title="xml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/fhir/StructureDefinition/extension-process-authorization&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;message-name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueString</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;some-message-name&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;task-profile&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueCanonical</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://foo.org/fhir/StructureDefinition/profile|#{version}&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;requester&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueCoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueIdentifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">					&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/sid/organization-identifier&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">					&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;identifier.remote.org&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueIdentifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/fhir/CodeSystem/process-authorization&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;REMOTE_ORGANIZATION&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueCoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;recipient&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueCoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> url</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/fhir/StructureDefinition/extension-process-authorization-organization&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueIdentifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">					&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/sid/organization-identifier&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">					&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">value</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;identifier.local.org&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">				&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueIdentifier</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">system</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;http://highmed.org/fhir/CodeSystem/process-authorization&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">			&lt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">code</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> value</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">=</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;LOCAL_ORGANIZATION&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> /&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">		&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">valueCoding</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">	&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&lt;/</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">extension</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="exercise-tasks" tabindex="-1"><a class="header-anchor" href="#exercise-tasks"><span>Exercise Tasks</span></a></h3><hr><ol><li>Modify the <code>highmedorg_helloDic</code> process in the <code>hello-dic.bpmn</code> file and replace the <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/none-events/#none-end-event" target="_blank" rel="noopener noreferrer">End Event</a> with a <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-end-event" target="_blank" rel="noopener noreferrer">Message End Event</a>. Configure input parameters <code>instantiatesUri</code>, <code>profile</code> and <code>messageName</code> in the BPMN model for the <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-end-event" target="_blank" rel="noopener noreferrer">Message End Event</a>. Set the message name of the <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-end-event" target="_blank" rel="noopener noreferrer">Message End Event</a> and configure it to be executed using the HelloCosMessage class.<br> Use <a href="http://highmed.org/fhir/StructureDefinition/task-hello-cos%7C#%7Bversion%7D" target="_blank" rel="noopener noreferrer">http://highmed.org/fhir/StructureDefinition/task-hello-cos|#{version}</a> as the profile and <code>helloCos</code> as the message name. Figure out what the appropriate <code>instantiatesUri</code> value is, based on the name (process definition key) of the process to be triggered.</li><li>Modify the <code>highmedorg_helloCos</code> process in the <code>hello-cos.bpmn</code> file and configure the message name of the <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-start-event" target="_blank" rel="noopener noreferrer">Message Start Event</a> with the same value as the message name of the <a href="https://docs.camunda.org/manual/7.17/reference/bpmn20/events/message-events/#message-end-event" target="_blank" rel="noopener noreferrer">Message End Event</a> in the <code>highmedorg_helloDic</code> process.</li><li>Create a new <a href="http://hl7.org/fhir/R4/structuredefinition.html" target="_blank" rel="noopener noreferrer">StructureDefinition</a> with a <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> profile for the <code>helloCos</code> message.</li><li>Create a new <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> resource for the <code>highmedorg_helloCos</code> process and configure the authorization extension to allow the <code>Test_DIC</code> organization as the requester and the <code>Test_COS</code> organization as the recipient.</li><li>Add the <code>highmedorg_helloCos</code> process and its resources to the <code>TutorialProcessPluginDefinition</code> class.</li><li>Modify <code>HelloDic</code> service class to set the <code>target</code> process variable for the <code>Test_COS</code> organization.</li><li>Configure the <code>HelloCosMessage</code> class as a spring in the <code>TutorialConfig</code> class.</li></ol><h3 id="solution-verification" tabindex="-1"><a class="header-anchor" href="#solution-verification"><span>Solution Verification</span></a></h3><hr><h4 id="maven-build-and-automated-tests" tabindex="-1"><a class="header-anchor" href="#maven-build-and-automated-tests"><span>Maven Build and Automated Tests</span></a></h4><p>Execute a maven build of the <code>dsf-process-tutorial</code> parent module via:</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>mvn clean install -Pexercise-3</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify that the build was successful and no test failures occurred.</p><h4 id="process-execution-and-manual-tests" tabindex="-1"><a class="header-anchor" href="#process-execution-and-manual-tests"><span>Process Execution and Manual Tests</span></a></h4><p>To verify the <code>highmedorg_helloDic</code> and <code>highmedorg_helloCos</code> processes can be executed successfully, we need to deploy them into DSF instances and execute the <code>highmedorg_helloDic</code> process. The maven <code>install</code> build is configured to create a process jar file with all necessary resources and copy the jar to the appropriate locations of the docker test setup.</p><ol><li>Start the DSF FHIR server for the <code>Test_DIC</code> organization in a console at location <code>.../dsf-process-tutorial/test-setup</code>:</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker-compose up dic-fhir</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify the DSF FHIR server started successfully.</p><ol start="2"><li>Start the DSF BPE server for the <code>Test_DIC</code> organization in another console at location <code>.../dsf-process-tutorial/test-setup</code>:</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker-compose up dic-bpe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify the DSF BPE server started successfully and deployed the highmedorg_helloDic process.</p><ol start="3"><li>Start the DSF FHIR server for the <code>Test_COS</code> organization in a console at location <code>.../dsf-process-tutorial/test-setup</code>:</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker-compose up cos-fhir</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify the DSF FHIR server started successfully. You can access the webservice of the DSF FHIR server at <a href="https://cos/fhir" target="_blank" rel="noopener noreferrer">https://cos/fhir</a>.<br> The DSF FHIR server uses a server certificate that was generated during the first maven build. To authenticate yourself to the server you can use the client certificate located at <code>.../dsf-process-tutorial/test-data-generator/cert/Webbrowser_Test_User/Webbrowser_Test_User_certificate.p12</code> (Password: password).</p><ol start="4"><li>Start the DSF BPE server for the <code>Test_COS</code> organization in another console at location <code>.../dsf-process-tutorial/test-setup</code>:</li></ol><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker-compose up cos-bpe</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div><p>Verify the DSF BPE server started successfully and deployed the <code>highmedorg_helloCos</code> process. The DSF BPE server should print a message that the process was deployed. The DSF FHIR server should now have a new <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> resource. Go to <a href="https://cos/fhir/ActivityDefinition" target="_blank" rel="noopener noreferrer">https://cos/fhir/ActivityDefinition</a> to check if the expected resource was created by the BPE while deploying the process. The returned FHIR <a href="http://hl7.org/fhir/R4/bundle.html" target="_blank" rel="noopener noreferrer">Bundle</a> should contain two <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> resources. Also, go to <a href="https://cos/fhir/StructureDefinition?url=http://highmed.org/fhir/StructureDefinition/task-hello-cos" target="_blank" rel="noopener noreferrer">https://cos/fhir/StructureDefinition?url=http://highmed.org/fhir/StructureDefinition/task-hello-cos</a> to check if the expected <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> profile was created.</p><ol start="5"><li>Start the <code>highmedorg_helloDic</code> process by posting a specific FHIR <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource to the DSF FHIR server of the <code>Test_DIC</code> organization: Execute therefore the <code>main</code> method of the <code>org.highmed.dsf.process.tutorial.TutorialExampleStarter</code> class to create the Task resource needed to start the <code>highmedorg_helloDic</code> process.</li></ol><p>Verify that the FHIR <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource was created at the DSF FHIR server and the <code>highmedorg_helloDic</code> process was executed by the DSF BPE server of the <code>Test_DIC</code> organization. The DSF BPE server of the <code>Test_DIC</code> organization should print a message showing that a <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource to start the <code>highmedorg_helloCos</code> process was send to the <code>Test_COS</code> organization.<br> Verify that a FHIR <a href="http://hl7.org/fhir/R4/task.html" target="_blank" rel="noopener noreferrer">Task</a> resource was created at the DSF FHIR server of the <code>Test_COS</code> organization and the <code>highmedorg_helloCos</code> process was then executed by the DSF BPE server of the <code>Test_COS</code> organization.</p>`,32)),n("p",null,[e[20]||(e[20]=i("Continue with ")),t(s,{to:"/oldstable/tutorial/exercise4-exclusiveGateways.html"},{default:a(()=>e[19]||(e[19]=[i("exercise 4")])),_:1}),e[21]||(e[21]=i("."))]),e[35]||(e[35]=n("hr",null,null,-1)),n("p",null,[t(s,{to:"/oldstable/tutorial/prerequisites.html"},{default:a(()=>e[22]||(e[22]=[i("Prerequisites")])),_:1}),e[28]||(e[28]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise1-simpleProcess.html"},{default:a(()=>e[23]||(e[23]=[i("Exercise 1")])),_:1}),e[29]||(e[29]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise11-processDebugging.html"},{default:a(()=>e[24]||(e[24]=[i("Exercise 1.1")])),_:1}),e[30]||(e[30]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise2-inputParameters.html"},{default:a(()=>e[25]||(e[25]=[i("Exercise 2")])),_:1}),e[31]||(e[31]=i(" | Exercise 3 | ")),t(s,{to:"/oldstable/tutorial/exercise4-exclusiveGateways.html"},{default:a(()=>e[26]||(e[26]=[i("Exercise 4")])),_:1}),e[32]||(e[32]=i(" | ")),t(s,{to:"/oldstable/tutorial/exercise5-eventBasedGateways.html"},{default:a(()=>e[27]||(e[27]=[i("Exercise 5")])),_:1})])])}const m=o(c,[["render",g],["__file","exercise3-messageEvents.html.vue"]]),v=JSON.parse('{"path":"/oldstable/tutorial/exercise3-messageEvents.html","title":"Exercise 3 - Message Events","lang":"en-US","frontmatter":{"title":"Exercise 3 - Message Events","icon":"slides","gitInclude":[]},"headers":[{"level":2,"title":"Exercise 3 - Message Events","slug":"exercise-3-message-events","link":"#exercise-3-message-events","children":[{"level":3,"title":"Introduction","slug":"introduction","link":"#introduction","children":[]},{"level":3,"title":"Exercise Tasks","slug":"exercise-tasks","link":"#exercise-tasks","children":[]},{"level":3,"title":"Solution Verification","slug":"solution-verification","link":"#solution-verification","children":[]}]}],"readingTime":{"minutes":6.16,"words":1849},"filePathRelative":"oldstable/tutorial/exercise3-messageEvents.md","excerpt":"<p><a href=\\"/oldstable/tutorial/prerequisites.html\\" target=\\"_blank\\">Prerequisites</a> | <a href=\\"/oldstable/tutorial/exercise1-simpleProcess.html\\" target=\\"_blank\\">Exercise 1</a> | <a href=\\"/oldstable/tutorial/exercise11-processDebugging.html\\" target=\\"_blank\\">Exercise 1.1</a> | <a href=\\"/oldstable/tutorial/exercise2-inputParameters.html\\" target=\\"_blank\\">Exercise 2</a> | Exercise 3 | <a href=\\"/oldstable/tutorial/exercise4-exclusiveGateways.html\\" target=\\"_blank\\">Exercise 4</a> | <a href=\\"/oldstable/tutorial/exercise5-eventBasedGateways.html\\" target=\\"_blank\\">Exercise 5</a></p>"}');export{m as comp,v as data};
