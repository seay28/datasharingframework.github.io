import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as s,a,o as n}from"./app-CJIENTLq.js";const t={};function l(r,e){return n(),s("div",null,e[0]||(e[0]=[a(`<h2 id="overview" tabindex="-1"><a class="header-anchor" href="#overview"><span>Overview</span></a></h2><p>The DSF FHIR server implements a subset of the FHIR R4 <a href="http://hl7.org/fhir/R4/http.html" target="_blank" rel="noopener noreferrer">REST API</a>. When accessing the API with a web browser a limited graphical user interface is shown. Without any additional configuration the API and user interface is only accessible with the X.509 client certificate configured for the organization via the configuration parameter: <a href="configuration#dev-dsf-fhir-server-organization-thumbprint">DEV_DSF_FHIR_SERVER_ORGANIZATION_THUMBPRINT</a></p><div class="hint-container tip"><p class="hint-container-title">OpenID Connect</p><p>To enable OpenID Connect authentication of local user, see the DSF FHIR server OpenID Connect <a href="oidc">configuration page</a>.</p></div><p>Access to the API and user interface can be enabled for additional client certificates and local users authenticating via OAuth 2.0 OpenID Connect. Access can be configured for so called roles, with all roles specified using the configuration parameter <a href="configuration#dev-dsf-fhir-server-roleconfig">DEV_DSF_FHIR_SERVER_ROLECONFIG</a>. The value for this environment variable is specified as YAML using the block scalar <code>|</code>.</p><p>The listing below shows a minimal configuration to enable read access for a specific client-certificate:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      DEV_DSF_FHIR_SERVER_ROLECONFIG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - example_read_only_role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            thumbprint: 00474993fa261b0225f93c5a66aa6fcc... [a-f0-9]{128}</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            dsf-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - READ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - SEARCH</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - HISTORY</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The list of user roles above contains a single rule-entry <code>example_read_only_role</code>, matching the user via a client certificate SHA-512 thumprint and assigning three DSF roles. Any string can be used as the name for the rule-enty.</p><div class="hint-container tip"><p class="hint-container-title">Certificate Thumbprints</p><p>SHA-512 certificate thumbprints in HEX form <code>[a-f0-9]{128}</code> can be calculated using:</p><div class="language-sh line-numbers-mode" data-highlighter="shiki" data-ext="sh" data-title="sh" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">certtool</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --fingerprint</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --hash=sha512</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> --infile=certificate.pem</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></div><p>Multiple user roles can be specified and all matching roles will be applied to an authenticated users. Use an empty string <code>&quot;&quot;</code> or a single block scalar <code>|</code> character as the value for the configuration parameter <a href="configuration#dev-dsf-fhir-server-roleconfig">DEV_DSF_FHIR_SERVER_ROLECONFIG</a> if no roles should be configured.</p><h2 id="matching-users" tabindex="-1"><a class="header-anchor" href="#matching-users"><span>Matching Users</span></a></h2><p>To apply roles, users can be matched via the <code>thumbprint</code>, <code>email</code>, <code>token-role</code> or <code>token-group</code> properties. A single value or a list of values can be specified.</p><h4 id="thumbprint" tabindex="-1"><a class="header-anchor" href="#thumbprint"><span>thumbprint</span></a></h4><p>The property <code>thumbprint</code> can used to specify one or multiple SHA-512 certificate thumbprints. Roles from this rule are applied to the authenticating user if the certificate matches one of the specified thumbprints.</p><h4 id="email" tabindex="-1"><a class="header-anchor" href="#email"><span>email</span></a></h4><p>Using the property <code>email</code> users can be matched against e-mail addresses specified in X.509 client certificates and in OpenID Connect access tokens. Values will be matched against e-mail addresses specified in the subject DN (via PKCS#9 extension 1.2.840.113549.1.9.1) and RFC-822 Name entries of the Subject Alternative Name field. If the user authenticates via OpenID Connect, the <code>email</code> <a href="https://openid.net/specs/openid-connect-core-1_0.html#StandardClaims" target="_blank" rel="noopener noreferrer">claim</a> from the access token will be matched against the property values.</p><h4 id="token-role-and-token-group" tabindex="-1"><a class="header-anchor" href="#token-role-and-token-group"><span>token-role and token-group</span></a></h4><p>With the properties <code>token-role</code> and <code>token-group</code> role and group names can be specified to match against role and group claims within OAuth 2.0 access tokens.</p><h2 id="dsf-and-practitioner-roles" tabindex="-1"><a class="header-anchor" href="#dsf-and-practitioner-roles"><span>DSF and Practitioner Roles</span></a></h2><p>Two types of roles can be applied to matched users.</p><h4 id="dsf-role" tabindex="-1"><a class="header-anchor" href="#dsf-role"><span>dsf-role</span></a></h4><p>DSF roles specified via the <code>dsf-role</code> property define general access to the REST API and user interface. Allowed values are:</p><p><code>CREATE</code>, <code>READ</code>, <code>UPDATE</code>, <code>DELETE</code>, <code>SEARCH</code>, <code>HISTORY</code>, <code>PERMANENT_DELETE</code> and <code>WEBSOCKET</code>.</p><h4 id="practitioner-role" tabindex="-1"><a class="header-anchor" href="#practitioner-role"><span>practitioner-role</span></a></h4><p>In order to allow users to start processes, the property <code>practitioner-role</code> can be used to assign codes from FHIR <a href="http://hl7.org/fhir/R4/codesystem.html" target="_blank" rel="noopener noreferrer">CodeSystem</a> resources. Codes are specified in the form <code>system-url|code</code>.<br> If the uses has a code specified here that match with a <code>requester</code> extension within the process plugin&#39;s <a href="http://hl7.org/fhir/R4/activitydefinition.html" target="_blank" rel="noopener noreferrer">ActivityDefinition</a> resource, the user can start the process if he also has the <code>dsf-role</code> <code>CREATE</code>.</p><p>Process plugins can defined and use there own code-systems. However, the DSF specifies a standard set of practitioner roles within the CodeSystem <code>http://dsf.dev/fhir/CodeSystem/practitioner-role</code>:</p><p><code>UAC_USER</code>, <code>COS_USER</code>, <code>CRR_USER</code>, <code>DIC_USER</code>, <code>DMS_USER</code>, <code>DTS_USER</code>, <code>HRP_USER</code>, <code>TTP_USER</code>, <code>AMS_USER</code> and <code>DSF_ADMIN</code>.</p><h2 id="examples" tabindex="-1"><a class="header-anchor" href="#examples"><span>Examples</span></a></h2><p>The first example defines a group of DSF administrators. Two client certificates match against this role:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      DEV_DSF_FHIR_SERVER_ROLECONFIG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - certificate-admins:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            thumbprint: </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - afb68b1d9d47e691b8b3d50fd9848467cada8b1c76f5f4b45f00c9f8432d505361a3ee27805f4aa06799d9ac8dace94b3f1942fce44d84866961259b13be825d</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - 2441bfddcad97eeb83c8c31fe181b90652787b8b59bf4e569219da7db4429e389479cb7c4a2f311e34217357d594ecad7d58ccfeef2a9e93c6fcf8d98897d88c</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            dsf-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - CREATE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - READ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - UPDATE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - DELETE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - SEARCH</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - HISTORY</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            practitioner-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - http://dsf.dev/fhir/CodeSystem/practitioner-role|DSF_ADMIN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The second example defines a group of DSF administrators by specifying an <code>admin</code> role that gets matched against OAuth 2.0 access tokens:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      DEV_DSF_FHIR_SERVER_ROLECONFIG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - token-role-admins:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            token-role: admin</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            dsf-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - CREATE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - READ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - UPDATE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - DELETE</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - SEARCH</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - HISTORY</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            practitioner-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - http://dsf.dev/fhir/CodeSystem/practitioner-role|DSF_ADMIN</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The third example allows read-only access. Two e-mail addresses are used to match this role. E-mail addresses from X.509 client certificates and OAuth 2.0 access tokens are matched:</p><div class="language-yaml line-numbers-mode" data-highlighter="shiki" data-ext="yaml" data-title="yaml" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">      DEV_DSF_FHIR_SERVER_ROLECONFIG</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">: </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">|</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        - read-only:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            email:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - first.user@test.org</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - second.user@test.org</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            dsf-role:</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - READ</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - SEARCH</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">              - HISTORY</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,33)]))}const h=i(t,[["render",l],["__file","access-control.html.vue"]]),o=JSON.parse('{"path":"/v1.5.0/maintain/fhir/access-control.html","title":"Access Control","lang":"en-US","frontmatter":{"title":"Access Control","icon":"config","gitInclude":[]},"headers":[{"level":2,"title":"Overview","slug":"overview","link":"#overview","children":[]},{"level":2,"title":"Matching Users","slug":"matching-users","link":"#matching-users","children":[]},{"level":2,"title":"DSF and Practitioner Roles","slug":"dsf-and-practitioner-roles","link":"#dsf-and-practitioner-roles","children":[]},{"level":2,"title":"Examples","slug":"examples","link":"#examples","children":[]}],"readingTime":{"minutes":2.52,"words":755},"filePathRelative":"v1.5.0/maintain/fhir/access-control.md","excerpt":"<h2>Overview</h2>\\n<p>The DSF FHIR server implements a subset of the FHIR R4 <a href=\\"http://hl7.org/fhir/R4/http.html\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">REST API</a>. When accessing the API with a web browser a limited graphical user interface is shown. Without any additional configuration the API and user interface is only accessible with the X.509 client certificate configured for the organization via the configuration parameter: <a href=\\"configuration#dev-dsf-fhir-server-organization-thumbprint\\">DEV_DSF_FHIR_SERVER_ORGANIZATION_THUMBPRINT</a></p>"}');export{h as comp,o as data};
