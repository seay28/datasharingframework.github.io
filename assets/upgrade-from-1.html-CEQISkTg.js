import{_ as i}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as e,a,o as n}from"./app-CJIENTLq.js";const l={};function r(t,s){return n(),e("div",null,s[0]||(s[0]=[a(`<p>Upgrading the DSF from 1.6.0 to 1.7.0 involves modifying the docker-compose.yml files and recreating the containers. In addition a number of docker secrets and environment variables can be removed if the newly introduced default values are sufficient. The now integrated defaults for trusted certificate authorities include updated configuration for the new certificate authority <em>HARICA</em> used by <em>DFN e.V.</em> and <em>GÉANT TCS</em>. See the <a href="root-certificates">Default Root Certificates</a> page for more details and to learn how to configure overrides.</p><p><strong>Note:</strong> The configurations of trust stores for TLS connections managed by process plugins (for example HTTPS connections to the local KDS FHIR server) have not been modified with this release.</p><h2 id="modify-dsf-fhir-server-setup" tabindex="-1"><a class="header-anchor" href="#modify-dsf-fhir-server-setup"><span>Modify DSF FHIR Server Setup</span></a></h2><ol><li><p>Preparation / Backup</p><ul><li>We recommend to create a backup of the <code>/opt/fhir</code> directory before proceeding with the upgrade.<br> For example using: <code>sudo cp -rp /opt/fhir /opt/fhir_backup_pre_1.7.0_upgrade</code></li></ul></li><li><p>Modify the DSF FHIR docker-compose.yml file, replace the version number with 1.7.0 and remove not needed secrets and environment variables.</p></li></ol><div class="language-diff line-numbers-mode" data-highlighter="shiki" data-ext="diff" data-title="diff" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> version: &#39;3.8&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> services:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   proxy:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    image: ghcr.io/datasharingframework/fhir_proxy:1.6.0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">+    image: ghcr.io/datasharingframework/fhir_proxy:1.7.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     restart: on-failure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - ssl_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - ssl_certificate_key_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - ssl_certificate_chain_file.pem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - ssl_ca_dn_request_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     environment:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       SSL_CERTIFICATE_FILE: /run/secrets/ssl_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       SSL_CERTIFICATE_KEY_FILE: /run/secrets/ssl_certificate_key_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       SSL_CERTIFICATE_CHAIN_FILE: /run/secrets/ssl_certificate_chain_file.pem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      SSL_CA_CERTIFICATE_FILE: /run/secrets/ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      SSL_CA_DN_REQUEST_FILE: /run/secrets/ssl_ca_dn_request_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     networks:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   app:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    image: ghcr.io/datasharingframework/fhir:1.6.0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">+    image: ghcr.io/datasharingframework/fhir:1.7.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     restart: on-failure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     secrets:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_liquibase.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_user.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_user_permanent_delete.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - app_client_trust_certificates.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate_private_key.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate_private_key.pem.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     volumes:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     environment:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       TZ: Europe/Berlin</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      DEV_DSF_SERVER_AUTH_TRUST_CLIENT_CERTIFICATE_CAS:  /run/secrets/ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_FHIR_DB_LIQUIBASE_PASSWORD_FILE: /run/secrets/db_liquibase.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_FHIR_DB_USER_PERMANENT_DELETE_PASSWORD_FILE: /run/secrets/db_user_permanent_delete.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      DEV_DSF_FHIR_CLIENT_TRUST_SERVER_CERTIFICATE_CAS: /run/secrets/app_client_trust_certificates.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_FHIR_CLIENT_CERTIFICATE: /run/secrets/app_client_certificate.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> secrets:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-  ssl_ca_certificate_file.pem:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    file: ./secrets/ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-  ssl_ca_dn_request_file.pem:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    file: ./secrets/ssl_ca_dn_request_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-  app_client_trust_certificates.pem:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    file: ./secrets/ssl_root_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li>Upgrade the DSF FHIR containers<br> From <code>/opt/fhir</code> execute<div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker compose up -d &amp;&amp; docker compose logs -f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ol><h2 id="modify-dsf-bpe-server-setup" tabindex="-1"><a class="header-anchor" href="#modify-dsf-bpe-server-setup"><span>Modify DSF BPE Server Setup</span></a></h2><ol><li><p>Preparation / Backup</p><ul><li>We recommend to create a backup of the <code>/opt/bpe</code> directory before proceeding with the upgrade.<br> For example using: <code>sudo cp -rp /opt/bpe /opt/bpe_backup_pre_1.7.0_upgrade</code></li></ul></li><li><p>Modify the DSF BPE docker-compose.yml file, replace the version number with 1.7.0 and remove not needed secrets and environment variables.</p></li></ol><div class="language-diff line-numbers-mode" data-highlighter="shiki" data-ext="diff" data-title="diff" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> version: &#39;3.8&#39;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> services:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">   app:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    image: ghcr.io/datasharingframework/bpe:1.6.0</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">+    image: ghcr.io/datasharingframework/bpe:1.7.0</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     restart: on-failure</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     secrets:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_liquibase.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_user.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - db_user_camunda.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - app_client_trust_certificates.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate_private_key.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       - app_client_certificate_private_key.pem.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      - ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     volumes:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">     environment:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       TZ: Europe/Berlin</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      DEV_DSF_SERVER_AUTH_TRUST_CLIENT_CERTIFICATE_CAS: /run/secrets/ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_BPE_DB_LIQUIBASE_PASSWORD_FILE: /run/secrets/db_liquibase.password</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_BPE_DB_USER_CAMUNDA_PASSWORD_FILE: /run/secrets/db_user_camunda.password</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-      DEV_DSF_BPE_FHIR_CLIENT_TRUST_SERVER_CERTIFICATE_CAS: /run/secrets/app_client_trust_certificates.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">       DEV_DSF_BPE_FHIR_CLIENT_CERTIFICATE: /run/secrets/app_client_certificate.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> secrets:</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-  app_client_trust_certificates.pem:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    file: ./secrets/ssl_root_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-  ssl_ca_certificate_file.pem:</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">-    file: ./secrets/ssl_ca_certificate_file.pem</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">...</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ol start="3"><li><p>Upgrade the DSF BPE containers<br> From <code>/opt/bpe</code> execute</p><div class="language- line-numbers-mode" data-highlighter="shiki" data-ext="" data-title="" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span>docker compose up -d &amp;&amp; docker compose logs -f</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li><li><p>Verify your upgrade:</p><ul><li>Verify the DSF FHIR server is running in version 1.7.0. The log should contain a message:<br><code>INFO main - BuildInfoReaderImpl.logBuildInfo(137) | Artifact: dsf-fhir-server-jetty, version: 1.7.0, [...]</code></li><li>Verify the DSF FHIR server started without errors</li><li>Verify the DSF FHIR server is accessible via https, for example by browsing to <a href="https://your-dsf-endpoint.de/fhir/" target="_blank" rel="noopener noreferrer">https://your-dsf-endpoint.de/fhir/</a> (authentication with your client-certificate)</li><li>Verify the DSF BPE server is running in version 1.7.0. The log should contain a message:<br><code>INFO main - BuildInfoReaderImpl.logBuildInfo(137) | Artifact: dsf-bpe-server-jetty, version: 1.7.0, [...]</code></li><li>Verify the DSF BPE server started without errors</li><li>Verify your install with a ping/pong test</li></ul></li></ol>`,10)]))}const c=i(l,[["render",r],["__file","upgrade-from-1.html.vue"]]),h=JSON.parse('{"path":"/v1.7.0/maintain/upgrade-from-1.html","title":"Upgrade from DSF 1.6.0","lang":"en-US","frontmatter":{"title":"Upgrade from DSF 1.6.0","icon":"update","gitInclude":[]},"headers":[{"level":2,"title":"Modify DSF FHIR Server Setup","slug":"modify-dsf-fhir-server-setup","link":"#modify-dsf-fhir-server-setup","children":[]},{"level":2,"title":"Modify DSF BPE Server Setup","slug":"modify-dsf-bpe-server-setup","link":"#modify-dsf-bpe-server-setup","children":[]}],"readingTime":{"minutes":1.66,"words":499},"filePathRelative":"v1.7.0/maintain/upgrade-from-1.md","excerpt":"<p>Upgrading the DSF from 1.6.0 to 1.7.0 involves modifying the docker-compose.yml files and recreating the containers. In addition a number of docker secrets and environment variables can be removed if the newly introduced default values are sufficient. The now integrated defaults for trusted certificate authorities include updated configuration for the new certificate authority <em>HARICA</em> used by <em>DFN e.V.</em> and <em>GÉANT TCS</em>. See the <a href=\\"root-certificates\\">Default Root Certificates</a> page for more details and to learn how to configure overrides.</p>"}');export{c as comp,h as data};
